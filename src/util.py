import os
import pygame
from src.settings import TILESIZE


class AStarCell:
    def __init__(self, val=1, pos=None):
        self.val = val
        self.count = None
        self.path_from = None
        self.pos = pos


def load_image(path):
    return pygame.transform.scale(pygame.image.load(path).convert_alpha(), (TILESIZE, TILESIZE))


def load_durability_images(path, prefix):
    imgs = {}
    for chunk in os.listdir(path):
        c = int(chunk)
        imgs[c] = {}
        for img in os.listdir(os.path.join(path, chunk)):
            img_path = os.path.join(path, chunk, img)
            key = int(img.replace(prefix, '').replace('.png', ''))
            imgs[c][key] = load_image(img_path)
    return imgs


neighbors8 = [
    (-1, -1), (0, -1), (+1, -1),
    (-1, 0), (+1, 0),
    (-1, +1), (0, +1), (+1, +1),
]


bitmask_map = {
    0: 0, 
    1: 0, 
    2: 2, 
    3: 2, 
    4: 0, 
    5: 0, 
    6: 2, 
    7: 2, 
    8: 8, 
    9: 8, 
    10: 10, 
    11: 11, 
    12: 8, 
    13: 8, 
    14: 10, 
    15: 11, 
    16: 16, 
    17: 16, 
    18: 18, 
    19: 18, 
    20: 16, 
    21: 16, 
    22: 22, 
    23: 22, 
    24: 24, 
    25: 24, 
    26: 26, 
    27: 27, 
    28: 24, 
    29: 24, 
    30: 30, 
    31: 31, 
    32: 0, 
    33: 0, 
    34: 2, 
    35: 2, 
    36: 0, 
    37: 0, 
    38: 2, 
    39: 2, 
    40: 8, 
    41: 8, 
    42: 10, 
    43: 11, 
    44: 8, 
    45: 8, 
    46: 10, 
    47: 11, 
    48: 16, 
    49: 16, 
    50: 18, 
    51: 18, 
    52: 16, 
    53: 16, 
    54: 22, 
    55: 22, 
    56: 24, 
    57: 24, 
    58: 26, 
    59: 27, 
    60: 24, 
    61: 24, 
    62: 30, 
    63: 31, 
    64: 64, 
    65: 64, 
    66: 66, 
    67: 66, 
    68: 64, 
    69: 64, 
    70: 66, 
    71: 66, 
    72: 72, 
    73: 72, 
    74: 74, 
    75: 75, 
    76: 72, 
    77: 72, 
    78: 74, 
    79: 75, 
    80: 80, 
    81: 80, 
    82: 82, 
    83: 82, 
    84: 80, 
    85: 80, 
    86: 86, 
    87: 86, 
    88: 88, 
    89: 88, 
    90: 90, 
    91: 91, 
    92: 88, 
    93: 88, 
    94: 94, 
    95: 95, 
    96: 64, 
    97: 64, 
    98: 66, 
    99: 66, 
    100: 64, 
    101: 64, 
    102: 66, 
    103: 66, 
    104: 104, 
    105: 104, 
    106: 106, 
    107: 107, 
    108: 104, 
    109: 104, 
    110: 106, 
    111: 107, 
    112: 80, 
    113: 80, 
    114: 82, 
    115: 82, 
    116: 80, 
    117: 80, 
    118: 86, 
    119: 86, 
    120: 120, 
    121: 120, 
    122: 122, 
    123: 123, 
    124: 120, 
    125: 120, 
    126: 126, 
    127: 127, 
    128: 0, 
    129: 0, 
    130: 2, 
    131: 2, 
    132: 0, 
    133: 0, 
    134: 2, 
    135: 2, 
    136: 8, 
    137: 8, 
    138: 10, 
    139: 11, 
    140: 8, 
    141: 8, 
    142: 10, 
    143: 11, 
    144: 16, 
    145: 16, 
    146: 18, 
    147: 18, 
    148: 16, 
    149: 16, 
    150: 22, 
    151: 22, 
    152: 24, 
    153: 24, 
    154: 26, 
    155: 27, 
    156: 24, 
    157: 24, 
    158: 30, 
    159: 31, 
    160: 0, 
    161: 0, 
    162: 2, 
    163: 2, 
    164: 0, 
    165: 0, 
    166: 2, 
    167: 2, 
    168: 8, 
    169: 8, 
    170: 10, 
    171: 11, 
    172: 8, 
    173: 8, 
    174: 10, 
    175: 11, 
    176: 16, 
    177: 16, 
    178: 18, 
    179: 18, 
    180: 16, 
    181: 16, 
    182: 22, 
    183: 22, 
    184: 24, 
    185: 24, 
    186: 26, 
    187: 27, 
    188: 24, 
    189: 24, 
    190: 30, 
    191: 31, 
    192: 64, 
    193: 64, 
    194: 66, 
    195: 66, 
    196: 64, 
    197: 64, 
    198: 66, 
    199: 66, 
    200: 72, 
    201: 72, 
    202: 74, 
    203: 75, 
    204: 72, 
    205: 72, 
    206: 74, 
    207: 75, 
    208: 208, 
    209: 208, 
    210: 210, 
    211: 210, 
    212: 208, 
    213: 208, 
    214: 214, 
    215: 214, 
    216: 216, 
    217: 216, 
    218: 218, 
    219: 219, 
    220: 216, 
    221: 216, 
    222: 222, 
    223: 223, 
    224: 64, 
    225: 64, 
    226: 66, 
    227: 66, 
    228: 64, 
    229: 64, 
    230: 66, 
    231: 66, 
    232: 104, 
    233: 104, 
    234: 106, 
    235: 107, 
    236: 104, 
    237: 104, 
    238: 106, 
    239: 107, 
    240: 208, 
    241: 208, 
    242: 210, 
    243: 210, 
    244: 208, 
    245: 208, 
    246: 214, 
    247: 214, 
    248: 248, 
    249: 248, 
    250: 250, 
    251: 251, 
    252: 248, 
    253: 248, 
    254: 254, 
    255: 255
}